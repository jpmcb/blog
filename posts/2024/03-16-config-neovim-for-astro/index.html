<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Editing Astro projects with Neovim | John McBride</title>
<meta name=keywords content><meta name=description content="Astro is a fast & dynamic web framework designed to be flexible
enough for small static websites, blogs, big interactive apps, and more.
I&rsquo;ve been interested in checking it out since building silly little static websites
that are &ldquo;Content-first&rdquo; is a fun past-time of mine.
Since Neovim is my main text editor, it took abit of configuration fu
to get things up and running.
Herein is my Astro setup:"><meta name=author content><link rel=canonical href=https://johncodes.com/posts/2024/03-16-config-neovim-for-astro/><link crossorigin=anonymous href=/assets/css/stylesheet.9329d037bc79464b26647fb72e079cd738f5d2418b1df4da3b515db9e22cb4d9.css integrity="sha256-kynQN7x5RksmZH+3Lgec1zj10kGLHfTaO1FdueIstNk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://johncodes.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://johncodes.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://johncodes.com/favicon-32x32.png><link rel=apple-touch-icon href=https://johncodes.com/apple-touch-icon.png><link rel=mask-icon href=https://johncodes.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://johncodes.com/posts/2024/03-16-config-neovim-for-astro/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Editing Astro projects with Neovim"><meta property="og:description" content="Astro is a fast & dynamic web framework designed to be flexible
enough for small static websites, blogs, big interactive apps, and more.
I&rsquo;ve been interested in checking it out since building silly little static websites
that are &ldquo;Content-first&rdquo; is a fun past-time of mine.
Since Neovim is my main text editor, it took abit of configuration fu
to get things up and running.
Herein is my Astro setup:"><meta property="og:type" content="article"><meta property="og:url" content="https://johncodes.com/posts/2024/03-16-config-neovim-for-astro/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-16T10:00:00-06:00"><meta property="article:modified_time" content="2024-03-16T10:00:00-06:00"><meta property="og:site_name" content="John-McBride"><meta name=twitter:card content="summary"><meta name=twitter:title content="Editing Astro projects with Neovim"><meta name=twitter:description content="Astro is a fast & dynamic web framework designed to be flexible
enough for small static websites, blogs, big interactive apps, and more.
I&rsquo;ve been interested in checking it out since building silly little static websites
that are &ldquo;Content-first&rdquo; is a fun past-time of mine.
Since Neovim is my main text editor, it took abit of configuration fu
to get things up and running.
Herein is my Astro setup:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://johncodes.com/posts/"},{"@type":"ListItem","position":2,"name":"Editing Astro projects with Neovim","item":"https://johncodes.com/posts/2024/03-16-config-neovim-for-astro/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Editing Astro projects with Neovim","name":"Editing Astro projects with Neovim","description":"Astro is a fast \u0026amp; dynamic web framework designed to be flexible enough for small static websites, blogs, big interactive apps, and more. I\u0026rsquo;ve been interested in checking it out since building silly little static websites that are \u0026ldquo;Content-first\u0026rdquo; is a fun past-time of mine.\nSince Neovim is my main text editor, it took abit of configuration fu to get things up and running.\nHerein is my Astro setup:\n","keywords":[],"articleBody":"Astro is a fast \u0026 dynamic web framework designed to be flexible enough for small static websites, blogs, big interactive apps, and more. I’ve been interested in checking it out since building silly little static websites that are “Content-first” is a fun past-time of mine.\nSince Neovim is my main text editor, it took abit of configuration fu to get things up and running.\nHerein is my Astro setup:\nPrerequisites You probably already have most of these tools installed since they have become synonymous with most Neovim configs:\nA newer version of Neovim - At the time of this writing, the latest version is v0.9.5. I typically recommend staying on the latest Neovim version since it gets you the latest features that various plugins may take advantage of. A package manager - these days, I (and it seems most of the Neovim community) typically recommend Lazy.nvim Treesitter for Neovim - an essential tool for syntax parsing and definitions. Install Treesitter parsers Astro files are actually amalgamations of several technologies. Depending on your Astro configuration, there may be HTML, Typescript, CSS, JavaScript, Tsx, etc.\nIn order to get syntax highlighting and parsing, you’ll need to install a few Treesitter parsers that enable Treesitter to introspect the different chunks of an Astro file:\nOn the Neovim command palate, first make sure Treesitter is updated:\n:TSUpdate Then, install the parsers:\n:TSInstall astro :TSInstall css :TSInstall typescript :TSInstall tsx Depending on your Treesitter setup, you may choose to ensure these parsers are always installed via the nvim-treesitter plugin:\nrequire(\"nvim-treesitter.configs\").setup({ ensured_installed = { \"astro\", \"css\", \"typescript\", \"tsx\", }, } This way, you don’t have to manually remember to install these parsers: they’ll just be there thanks to Treesitter’s config.\nTreesitter grammar plugin Having the parsers alone won’t give Treesitter everything it needs to correctly parse and crawl your Astro files: you’ll also need to install this community plugin that provides Treesitter with the appropriate grammar for how to actually use the parsers we’ve installed to interpret those files.\nIn the future, this may eventually be upstreamed into Treesitter itself. But for now, at the time of this writing, you’ll need this additional plugin to instruct Treesitter on how to understand .astro files.\nIn short, this ensures that the Astro specification is understood by Treesitter:\n--- {typescript} --- {html} having Typescript highlighting and syntax definitions in the frontmatter. And HTML / Tsx in the rest of the .astro file.\nTo install the plugin, using Lazy in your lua configs:\n-- Astro treesitter grammar bindings { \"virchau13/tree-sitter-astro\" }, Astro language server As you may already know, language servers for Neovim are the bread and butter of modern code editing. Without one, you’re almost back to the dark age.\nIn order to get modern functionality when editing your Astro files (like inline suggestions, “Go to definition”, “Refactor across project”, “Find types”, etc.) you’ll need an Astro language server.\nTo install the server for use by Neovim, you can get it globally via npm:\nnpm install -g @astrojs/language-server Optional: Install language server through Mason These days, I’ve moved away from installing one off bespoke editor tools from a myriad of ecosystems. And, instead, have chosen to unify my editor toolchain using Mason:\n:MasonInstall astro-language-server This installs the language server through the Mason framework and allows me to manage all of my Neovim editor tools (LSPs, DAPs, linters, etc.) from within Mason instead of through one off package managers. More importantly, it gives me consistency across the many different machines I may be using my Neovim configs with: no more jumping to a new machine and having to remember what commands I used to install some random, one-off tool. Now, it’s all just managed by Mason.\nFurther, within Mason’s config (and the mason-lspconfig config helper plugin) I can force the Astro language server to be installed automatically.\nrequire(\"mason\").setup() -- Ensures the servers named in nvim-lspconfig are installed by Mason -- github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md require(\"mason-lspconfig\").setup({ ensure_installed = { \"astro\", }, }) Configure your Astro language server To actually enable and attach your Astro language server when editing .astro files, you’ll need to configure it via the nvim-lspconfig plugin; the configuration binding plugin for all language servers used by Neovim.\nTo install nvim-lspconfig via Lazy.nvim:\n-- nvim LSP configs { \"neovim/nvim-lspconfig\" }, Configuring the language server is actually rather simple, but it’s an important step to ensure .astro files are “seen” by Neovim and attached to your installed Astro language server:\nlocal lspconfig = require(\"lspconfig\") -- Astro langauge server lspconfig.astro.setup({}) For a full understanding of the defaults and possible configuration options, read up on it here.\nFin And that’s it! This gets you the basic setup with syntax highlighting, the Astro language server, etc. Happy coding!\n","wordCount":"782","inLanguage":"en","datePublished":"2024-03-16T10:00:00-06:00","dateModified":"2024-03-16T10:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://johncodes.com/posts/2024/03-16-config-neovim-for-astro/"},"publisher":{"@type":"Organization","name":"John McBride","logo":{"@type":"ImageObject","url":"https://johncodes.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://johncodes.com/ accesskey=h title="John McBride (Alt + H)">John McBride</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://johncodes.com/archives title=Writing><span>Writing</span></a></li><li><a href=https://johncodes.com/index.xml title=RSS><span>RSS</span></a></li><li><a href=https://johncodes.com/talks/ title=Talks><span>Talks</span></a></li><li><a href=https://johncodes.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://johncodes.com/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Editing Astro projects with Neovim</h1><div class=post-meta><span title='2024-03-16 10:00:00 -0600 -0600'>March 16, 2024</span></div></header><div class=post-content><p><a href=https://astro.build/>Astro</a> is a fast & dynamic web framework designed to be flexible
enough for small static websites, blogs, big interactive apps, and more.
I&rsquo;ve been interested in checking it out since building silly little static websites
that are &ldquo;Content-first&rdquo; is a fun past-time of mine.</p><p>Since Neovim is my main text editor, it took <em>abit</em> of configuration fu
to get things up and running.</p><p>Herein is my Astro setup:</p><hr><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><p>You probably already have most of these tools installed since they have become
synonymous with most Neovim configs:</p><ul><li>A newer version of <a href=https://github.com/neovim/neovim>Neovim</a> -
At the time of this writing, <a href=https://github.com/neovim/neovim/releases/tag/v0.9.5>the latest version is v0.9.5</a>.
I typically recommend staying on the latest Neovim version since it gets you the latest
features that various plugins may take advantage of.</li><li>A package manager - these days, I (and it seems most of the Neovim community)
typically recommend <a href=https://github.com/folke/lazy.nvim>Lazy.nvim</a></li><li><a href=https://github.com/nvim-treesitter/nvim-treesitter>Treesitter for Neovim</a> - an essential tool
for syntax parsing and definitions.</li></ul><h2 id=install-treesitter-parsers>Install Treesitter parsers<a hidden class=anchor aria-hidden=true href=#install-treesitter-parsers>#</a></h2><p>Astro files are actually amalgamations of several technologies.
Depending on your Astro configuration, there may be HTML, Typescript, CSS, JavaScript, Tsx, etc.</p><p>In order to get syntax highlighting and parsing, you&rsquo;ll need to install
a few Treesitter parsers that enable Treesitter to introspect the different
chunks of an Astro file:</p><p>On the Neovim command palate, first make sure Treesitter is updated:</p><pre tabindex=0><code>:TSUpdate
</code></pre><p>Then, install the parsers:</p><pre tabindex=0><code>:TSInstall astro
:TSInstall css
:TSInstall typescript
:TSInstall tsx
</code></pre><p>Depending on your Treesitter setup, you may choose to ensure these parsers are always
installed via the <code>nvim-treesitter</code> plugin:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>require(<span style=color:#e6db74>&#34;nvim-treesitter.configs&#34;</span>).setup({
</span></span><span style=display:flex><span>	ensured_installed <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;astro&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;css&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;typescript&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;tsx&#34;</span>,
</span></span><span style=display:flex><span>	},
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This way, you don&rsquo;t have to manually remember to install these parsers:
they&rsquo;ll just be there thanks to Treesitter&rsquo;s config.</p><h2 id=treesitter-grammar-plugin>Treesitter grammar plugin<a hidden class=anchor aria-hidden=true href=#treesitter-grammar-plugin>#</a></h2><p>Having the parsers alone won&rsquo;t give Treesitter everything it needs to correctly
parse and crawl your Astro files: you&rsquo;ll also need to install <a href=https://github.com/virchau13/tree-sitter-astro>this community</a>
plugin that provides Treesitter with the appropriate grammar for how to <em>actually</em>
use the parsers we&rsquo;ve installed to interpret those files.</p><p>In the future, this may eventually be upstreamed into Treesitter itself.
But for now, at the time of this writing, you&rsquo;ll need this additional plugin
to instruct Treesitter on how to understand <code>.astro</code> files.</p><p>In short, this ensures that the Astro specification is understood by Treesitter:</p><pre tabindex=0><code>---
{typescript}
---
{html}
</code></pre><p>having Typescript highlighting and syntax definitions in the frontmatter.
And HTML / Tsx in the rest of the <code>.astro</code> file.</p><p>To install the plugin, using Lazy in your lua configs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#75715e>-- Astro treesitter grammar bindings</span>
</span></span><span style=display:flex><span>{ <span style=color:#e6db74>&#34;virchau13/tree-sitter-astro&#34;</span> },
</span></span></code></pre></div><h2 id=astro-language-server>Astro language server<a hidden class=anchor aria-hidden=true href=#astro-language-server>#</a></h2><p>As you may already know, language servers for Neovim are the bread and butter
of modern code editing. Without one, you&rsquo;re <em>almost</em> back to the dark age.</p><p>In order to get modern functionality when editing your Astro files
(like inline suggestions, &ldquo;Go to definition&rdquo;, &ldquo;Refactor across project&rdquo;, &ldquo;Find types&rdquo;, etc.)
you&rsquo;ll need an Astro language server.</p><p>To install the server for use by Neovim, you can get it globally via <code>npm</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>npm install -g @astrojs/language-server
</span></span></code></pre></div><h4 id=optional-install-language-server-through-mason>Optional: Install language server through Mason<a hidden class=anchor aria-hidden=true href=#optional-install-language-server-through-mason>#</a></h4><p>These days, I&rsquo;ve moved away from installing one off bespoke editor tools
from a myriad of ecosystems.
And, instead, have chosen to unify my editor toolchain using <a href=https://github.com/williamboman/mason.nvim>Mason</a>:</p><pre tabindex=0><code>:MasonInstall astro-language-server
</code></pre><p>This installs the language server through the Mason framework
and allows me to manage <em>all</em> of my Neovim editor tools (LSPs, DAPs, linters, etc.)
from within Mason instead of through one off package managers.
More importantly, it gives me consistency across the many different machines
I may be using my Neovim configs with:
no more jumping to a new machine and having to remember
what commands I used to install some random, one-off tool.
Now, it&rsquo;s all just managed by Mason.</p><p>Further, within Mason&rsquo;s config (and the <code>mason-lspconfig</code> config helper plugin)
I can force the Astro language server to be installed automatically.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>require(<span style=color:#e6db74>&#34;mason&#34;</span>).setup()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Ensures the servers named in nvim-lspconfig are installed by Mason</span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>require(<span style=color:#e6db74>&#34;mason-lspconfig&#34;</span>).setup({
</span></span><span style=display:flex><span>	ensure_installed <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>		<span style=color:#e6db74>&#34;astro&#34;</span>,
</span></span><span style=display:flex><span>	},
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h2 id=configure-your-astro-language-server>Configure your Astro language server<a hidden class=anchor aria-hidden=true href=#configure-your-astro-language-server>#</a></h2><p>To actually enable and attach your Astro language server when editing <code>.astro</code> files,
you&rsquo;ll need to configure it via <a href=https://github.com/neovim/nvim-lspconfig>the <code>nvim-lspconfig</code> plugin</a>;
the configuration binding plugin for all language servers used by Neovim.</p><p>To install <code>nvim-lspconfig</code> via Lazy.nvim:</p><pre tabindex=0><code>-- nvim LSP configs
{ &#34;neovim/nvim-lspconfig&#34; },
</code></pre><p>Configuring the language server is actually rather simple, but it&rsquo;s an important step
to ensure <code>.astro</code> files are &ldquo;seen&rdquo; by Neovim and attached to your installed Astro language server:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#66d9ef>local</span> lspconfig <span style=color:#f92672>=</span> require(<span style=color:#e6db74>&#34;lspconfig&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Astro langauge server</span>
</span></span><span style=display:flex><span>lspconfig.astro.setup({})
</span></span></code></pre></div><p>For a full understanding of the defaults and possible configuration options,
<a href=https://github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md#astro>read up on it here</a>.</p><h2 id=fin>Fin<a hidden class=anchor aria-hidden=true href=#fin>#</a></h2><p>And that&rsquo;s it! This gets you the basic setup with syntax highlighting, the Astro language server, etc.
Happy coding!</p><script src=https://giscus.app/client.js data-repo=jpmcb/blog data-repo-id="MDEwOlJlcG9zaXRvcnkxMTYxODMyNjg=" data-category="Blog comments" data-category-id=DIC_kwDOBuzQ5M4CTbHW data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=dark_dimmed data-lang=en data-loading=lazy crossorigin=anonymous async></script></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://johncodes.com/>John McBride</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>