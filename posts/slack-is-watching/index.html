<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Slack Is Always Watching ... | John McBride üë®‚Äçüíª</title><meta name=keywords content>
<meta name=description content="(Note: this is from a blog archieve dated 2019/01/21. These opinions are my own and the slack API may have changed) TLDR: The Slack API exposes endpoints for a token holder to read all public and private messages.
In today&rsquo;s world, violations of privacy are no surprise. Between all the leaks and data dumps, many people have accepted this as &ldquo;just the world we live in&rdquo;. But what if information was exposed that could be used to judge your work performance?">
<meta name=author content="John McBride">
<link rel=canonical href=johncodes.dev/posts/slack-is-watching/>
<link crossorigin=anonymous href=/johncodes.dev/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/johncodes.dev/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=johncodes.dev/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=johncodes.dev/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=johncodes.dev/favicon-32x32.png>
<link rel=apple-touch-icon href=johncodes.dev/apple-touch-icon.png>
<link rel=mask-icon href=johncodes.dev/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Slack Is Always Watching ...">
<meta property="og:description" content="(Note: this is from a blog archieve dated 2019/01/21. These opinions are my own and the slack API may have changed) TLDR: The Slack API exposes endpoints for a token holder to read all public and private messages.
In today&rsquo;s world, violations of privacy are no surprise. Between all the leaks and data dumps, many people have accepted this as &ldquo;just the world we live in&rdquo;. But what if information was exposed that could be used to judge your work performance?">
<meta property="og:type" content="article">
<meta property="og:url" content="johncodes.dev/posts/slack-is-watching/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-01-21T21:18:06-07:00">
<meta property="article:modified_time" content="2019-01-21T21:18:06-07:00"><meta property="og:site_name" content="John-McBride">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Slack Is Always Watching ...">
<meta name=twitter:description content="(Note: this is from a blog archieve dated 2019/01/21. These opinions are my own and the slack API may have changed) TLDR: The Slack API exposes endpoints for a token holder to read all public and private messages.
In today&rsquo;s world, violations of privacy are no surprise. Between all the leaks and data dumps, many people have accepted this as &ldquo;just the world we live in&rdquo;. But what if information was exposed that could be used to judge your work performance?">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"johncodes.dev/posts/"},{"@type":"ListItem","position":2,"name":"Slack Is Always Watching ...","item":"johncodes.dev/posts/slack-is-watching/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Slack Is Always Watching ...","name":"Slack Is Always Watching ...","description":"(Note: this is from a blog archieve dated 2019/01/21. These opinions are my own and the slack API may have changed) TLDR: The Slack API exposes endpoints for a token holder to read all public and private messages.\nIn today\u0026rsquo;s world, violations of privacy are no surprise. Between all the leaks and data dumps, many people have accepted this as \u0026ldquo;just the world we live in\u0026rdquo;. But what if information was exposed that could be used to judge your work performance?","keywords":[],"articleBody":"(Note: this is from a blog archieve dated 2019/01/21. These opinions are my own and the slack API may have changed) TLDR: The Slack API exposes endpoints for a token holder to read all public and private messages.\nIn today‚Äôs world, violations of privacy are no surprise. Between all the leaks and data dumps, many people have accepted this as ‚Äújust the world we live in‚Äù. But what if information was exposed that could be used to judge your work performance? Or steal your company‚Äôs intellectual property?\nIn this post, I will show how a Slack app could potentially leverage the Slack API to snoop on all public and private messages in a Slack workspace.\nThe veil of privacy A slack private message is not truly private. It is only hidden behind a thin veil of secrecy. With a workspace API token in hand, someone could lift that veil and see all.\nHere, with a short example, we will show how easily that can be done.\nFirst, the workspace owner or admin (depending on permissions), must access the Slack API website. There, they can build an app or give third party permissions to install a ‚Äúmarketplace‚Äù app. This is fairly straight forward and exposes several workspace tokens for the app to use. These are secret tokens, so they will be omitted in this example.\nNext, the app builder must enable the ‚Äúmessage‚Äù workspace event. If I was a nefarious third-party app builder, I would simply request various permissions related to channel, im, or group ‚Äúhistory‚Äù. For a full list of events and their permission scope, see this list.\nNext, if building the app, an endpoint must be designated for the API to send the event payload. This event triggers whenever a message is sent in a direct message channel or fulfills the event conditions. For a full description of the Slack API event loop, check this out.\nNow that we have the API set up to send event payloads, lets build a small Node Express app with an endpoint to receive the event json.\n// Events API endpoint app.post('/events', (req, res) = {  switch (req.body.type) {  case 'url_verification': {  // verifies events API endpoint  res.send({ challenge: req.body.challenge });  break;  }   case 'event_callback': {   // Respond immediately to prevent a timeout error  res.sendStatus(200);  const event = req.body.event;   // Print the message contents  if(event.type == 'message') {  console.log('User: ', event.user);  console.log('Text: ', event.text);   // Do other nefarious things with events json  }  }  } }) In this short node express endpoint, we can respond with the event token (necessary for verifying the app when challenged) and snoop on private messages. Let‚Äôs use ngork, start the express app, and send a private message:\nApp listening on port 8080! User: UBB22VCKC Text: hello world We can see that my Slack user ID is exposed and the message I sent is exposed. At this point, the app could do anything with this information.\nThis not only applies to single channel DMs, but the Slack API exposes several event subscriptions for message events in specific channels, specific groups, multiparty direct messages, private channels, and even every message sent in a workspace. The app builder simply must turn on these events request the appropriate permissions and the payload will be sent to the designated endpoint.\nIn short, it requires very little configuration and code to access and expose private Slack messages.\nWhat can you do?   Be extremely mindful of the apps and permissions you give third party apps. Ask yourself basic questions about these permissions. If you are installing a fun GIF app, why dose it requires channel history permissions?\n  Use Slack apps that have been made open source. Don‚Äôt hesitate to poke around a repository if you are questioning why an app requires certain permissions!\n  Request that any custom apps your Slack workspace uses are made open source.\n  ","wordCount":"642","inLanguage":"en","datePublished":"2019-01-21T21:18:06-07:00","dateModified":"2019-01-21T21:18:06-07:00","author":{"@type":"Person","name":"John McBride"},"mainEntityOfPage":{"@type":"WebPage","@id":"johncodes.dev/posts/slack-is-watching/"},"publisher":{"@type":"Organization","name":"John McBride üë®‚Äçüíª","logo":{"@type":"ImageObject","url":"johncodes.dev/favicon.ico"}}}</script>
</head><body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=johncodes.dev/ accesskey=h title="John McBride üë®‚Äçüíª (Alt + H)">John McBride üë®‚Äçüíª</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div><ul id=menu>
<li>
<a href=johncodes.dev/pgp-key.txt title="PGP Key">
<span>PGP Key</span>
</a>
</li><li>
<a href=johncodes.dev/about title=About>
<span>About</span>
</a>
</li><li>
<a href=johncodes.dev/archives title=Archive>
<span>Archive</span>
</a>
</li><li>
<a href=johncodes.dev/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li></ul></nav></header><main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Slack Is Always Watching ...
</h1><div class=post-meta><span title="2019-01-21 21:18:06 -0700 -0700">January 21, 2019</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;John McBride&nbsp;|&nbsp;<a href=https://github.com/jpmcb/blog/tree/main/content/posts/slack-is-watching.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div></header><div class=post-content><p>(Note: this is from a blog archieve dated 2019/01/21. These opinions are my own and the slack API may have changed)
TLDR: The Slack API exposes endpoints for a token holder to read all public and private messages.</p><p>In today&rsquo;s world, violations of privacy are no surprise. Between all the leaks and data dumps, many people have accepted this as &ldquo;just the world we live in&rdquo;. But what if information was exposed that could be used to judge your work performance? Or steal your company‚Äôs intellectual property?</p><p>In this post, I will show how a Slack app could potentially leverage the Slack API to snoop on all public and private messages in a Slack workspace.</p><h2 id=the-veil-of-privacy>The veil of privacy<a hidden class=anchor aria-hidden=true href=#the-veil-of-privacy>#</a></h2><p>A slack private message is not truly private. It is only hidden behind a thin veil of secrecy. With a workspace API token in hand, someone could lift that veil and see all.</p><p>Here, with a short example, we will show how easily that can be done.</p><p>First, the workspace owner or admin (depending on permissions), must access the <a href=https://api.slack.com/>Slack API website</a>. There, they can build an app or give third party permissions to install a ‚Äúmarketplace‚Äù app. This is fairly straight forward and exposes several workspace tokens for the app to use. These are secret tokens, so they will be omitted in this example.</p><p>Next, the app builder must enable the <a href=https://api.slack.com/events/message>&ldquo;message&rdquo; workspace event.</a> If I was a nefarious third-party app builder, I would simply request various permissions related to channel, im, or group &ldquo;history&rdquo;. For a full list of events and their permission scope, see <a href=https://api.slack.com/docs/oauth-scopes>this list.</a></p><p>Next, if building the app, an endpoint must be designated for the API to send the event payload. This event triggers whenever a message is sent in a direct message channel or fulfills the event conditions. For a full description of the Slack API event loop, <a href=https://api.slack.com/events-api#the_event_loop>check this out.</a></p><p>Now that we have the API set up to send event payloads, lets build a small Node Express app with an endpoint to receive the event json.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Events API endpoint
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;/events&#39;</span>, (<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>res</span>)  =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>type</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;url_verification&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// verifies events API endpoint 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>send</span>({ <span style=color:#a6e22e>challenge</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>challenge</span> });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;event_callback&#39;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Respond immediately to prevent a timeout error
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>sendStatus</span>(<span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>event</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>event</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Print the message contents
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;message&#39;</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;User: &#39;</span>, <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>user</span>);
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Text: &#39;</span>, <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>text</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// Do other nefarious things with events json
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>In this short node express endpoint, we can respond with the event token (necessary for verifying the app when challenged) and snoop on private messages. Let‚Äôs use <a href=https://ngrok.com/>ngork</a>, start the express app, and send a private message:</p><pre tabindex=0><code>App listening on port 8080!
User:  UBB22VCKC
Text:  hello world
</code></pre><p>We can see that my Slack user ID is exposed and the message I sent is exposed. At this point, the app could do anything with this information.</p><p>This not only applies to single channel DMs, but the Slack API exposes several event subscriptions for message events in specific channels, specific groups, multiparty direct messages, private channels, and even every message sent in a workspace. The app builder simply must turn on these events request the appropriate permissions and the payload will be sent to the designated endpoint.</p><p>In short, it requires very little configuration and code to access and expose private Slack messages.</p><h2 id=what-can-you-do>What can you do?<a hidden class=anchor aria-hidden=true href=#what-can-you-do>#</a></h2><ol>
<li>
<p>Be extremely mindful of the apps and permissions you give third party apps. Ask yourself basic questions about these permissions. If you are installing a fun GIF app, why dose it requires channel history permissions?</p></li><li>
<p>Use Slack apps that have been made open source. Don&rsquo;t hesitate to poke around a repository if you are questioning why an app requires certain permissions!</p></li><li>
<p>Request that any custom apps your Slack workspace uses are made open source.</p></li></ol></div><footer class=post-footer>
</footer></article></main><footer class=footer>
<span>&copy; 2022 <a href=johncodes.dev/>John McBride üë®‚Äçüíª</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script>
<script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script>
</body></html>